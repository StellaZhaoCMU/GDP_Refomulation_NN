GAMS 24.8.4  r60966 Released Apr 10, 2017 LEX-LEG x86 64bit/Linux                                                                                                                                                                      04/09/18 11:41:03 Page 7
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
C o m p i l a t i o n


 194  positive variables it(t), f(t,r), ix(t,r);
 195  Variables
 196       cost        objective variable
 197       x(var)
 198       ni(k,i,var);
 199  Binary variable y(k,i);
 200   
 201   
 202  equation obj, disj_ineq(k,i,e), sum_bin(k), disj_ineq_hr(k,i,e), disag(k,var), bound_up(k,i,var), bound_lo(k,i,var), disj_fix
 203       eq2
 204       eq3
 205       eq4
 206       eq5
 207  ;
 208   
 209  alias (level,level2,k,kk),(i,ii,iii),(ki,ki2);
 210  set node(level,k,i),cur_node(k,i),alive_ki(k,i);alive_ki(ki)=yes;node(level,k,i)=no;cur_node(k,i)=no;
 211  alias (node,node2);
 212   
 213  obj.. cost =e= sum(t,IC(t)*it(t)) + sum(map_var_c(var,t,r),x(var));
 214  eq2(t).. it(t) =e= sum(r,ix(t,r));
 215  eq3(t,r).. - f(t,r) =l= -D(t,r);
 216  eq4(t,r).. ix(t,r) =e= ix(t-1,r)$(ord(t)>1) + sum(map_var_x(var,t,r),x(var)) - f(t,r);
 217  eq5(t,r)$(ord(t)>=2)..  sum((k,i)$logic_left(t,r,k,i),y(k,i)) =e= sum((tt,k,i)$logic_right(t,r,k,tt,i),y(k,i));
 218   
 219  disj_ineq(k,i,e)$(kie(k,i,e) and alive_ki(k,i)).. sum(var$(A(k,i,e,var)<>0),A(k,i,e,var)*x(var)) =l= b(k,i,e) + opt_bigm(k,i,e)*(1-y(k,i));
 220  disj_fix(k,i,e)$(kie(k,i,e) and cur_node(k,i)).. sum(var$(A(k,i,e,var)<>0),A(k,i,e,var)*x(var)) =l= b(k,i,e);
 221   
 222  disag(k,var)$(kv(k,var) and (sum(alive_ki(k,i),1)>=1) ).. x(var) =e= sum(ki(k,i),ni(ki,var));
 223  disj_ineq_hr(k,i,e)$(kie(k,i,e) and alive_ki(k,i)).. sum(var$(A(k,i,e,var)<>0),A(k,i,e,var)*ni(k,i,var)) =l= b(k,i,e)*y(k,i);
 224  bound_up(ki(k,i),var)$(kv(k,var) and alive_ki(ki) ).. ni(ki,var) =l= x.up(var)*y(ki);
 225  bound_lo(ki(k,i),var)$(kv(k,var) and alive_ki(ki) ).. ni(ki,var) =g= x.lo(var)*y(ki);
 226   
 227   
 228   
 229  sum_bin(k).. sum(ki(k,i),y(ki)) =e= 1;
 230   
 231  option optcr = 0.001
 232         reslim = 7200
 233  *       rmip=cbc
 234    ;
 235   
 236  model bigM /obj, disj_ineq, disj_fix, sum_bin,  eq2, eq3, eq4, eq5/;
 237  bigM.optfile = 1;
 238  model chull /obj, disag, disj_ineq_hr, bound_up, bound_lo, disj_fix, sum_bin,  eq2, eq3, eq4, eq5/;
 239  chull.optfile = 1;
 240   
 241  x.lo(var) = lb(var);
 242  x.up(var) = ub(var);
 243   
INCLUDE    /home/bernalde/IntroToMLProj/GDP_Refomulation_NN/data/Logic_based_B_B_contracts/Euler/4/max_time_ref.gms
 245  option reslim = 7200;
 246   
GAMS 24.8.4  r60966 Released Apr 10, 2017 LEX-LEG x86 64bit/Linux                                                                                                                                                                      04/09/18 11:41:03 Page 8
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
C o m p i l a t i o n


 247   
 248  *code sets and parameters
 249  set numm /1*500000/,nnode(numm,k,k,i);nnode(numm,k,k,i)=no;
 250  set numm_aux1(numm), numm_aux2(numm); numm_aux1(numm)=no;numm_aux2(numm)=no;
 251  set nnode2(numm,k,k,i);nnode2(numm,k,k,i)=no;
 252  alias(numm,numm2);
 253  set chec_int_k(k),k_select(k);
 254   
 255  parameter chec_int(k,i), chec_int2(k,i), opt_y(k,i), opt_x(var), no_ki_param(k,i),lag_param(k);
 256  *node_val(k,k,i),node_stat(k,k,i),node_int(k,k,i);
 257  parameter node_val(numm),node_stat(numm),node_int(numm), parent_val(numm);
 258   
 259  scalar tol /1e-3/
 260         gap /1e-3/
 261         int_sol
 262         int_sol2
 263         int_sol3
 264         check_opt
 265         min_i
 266         UBP /1e10/
 267         LBP
 268         new_UB
 269         aux1
 270         aux2      /0/
 271         aux3
 272         cnt_nodes /1/
 273         time_start
 274         cpu_time /0/
 275         time_wall
 276         time_solve /0/
 277         cnt_calculate_LB /1/
 278         calculate_LB  /15/
 279         first_inter
 280         first_inter_val
 281         aux_inter /0/
 282         best_inter
 283         best_inter_cnt /0/
 284         time_limit /7200/
 285  ;
 286  *sets and paraemeters to save results
 287  parameter max_nod(k);max_nod('1')=0;
 288  set time_set /1*100000/
 289      resu /N_nodes,LB,UB/;
 290  parameter tot_results_w_time(time_set,resu),tot_results_s_time(time_set,resu);
 291   
 292  term(k)=sum(ki(k,i),1);
 293  aux2=1;lag_param(k)=0;aux1=2;
 294  aux2=0;aux1=1;
 295  time_start = jnow;
 296   
 297  solve bigM using rmip min cost;
 298  time_solve = time_solve + bigM.etsolve;
 299  cpu_time = cpu_time + bigM.resUsd;
GAMS 24.8.4  r60966 Released Apr 10, 2017 LEX-LEG x86 64bit/Linux                                                                                                                                                                      04/09/18 11:41:03 Page 9
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
C o m p i l a t i o n


 300  time_wall = (jnow-time_start)*3600*24;
 301   
 302   
 303  *Check integrality
 304  chec_int(k,i)=0; int_sol=0;
 305  loop(ki, if((y.l(ki)>=1-tol or y.l(ki)<=tol),chec_int(ki)=1););
 306  chec_int_k(k)=no;
 307  if(sum(ki,chec_int(ki))=sum(ki,1),int_sol=1; else chec_int_k(k)=yes; );
 308  check_opt=int_sol;
 309  if(int_sol=0,LBP=bigM.objval;);
 310  if(int_sol=1,UBP=bigM.objval;);
 311  node_val('1') = LBP;
 312   
 313  *report node 0
 314  tot_results_w_time(time_set,'UB')$(ord(time_set)=round(time_wall,0)) =  UBP ;
 315  tot_results_w_time(time_set,'LB')$(ord(time_set)=round(time_wall,0)) =  LBP ;
 316  tot_results_w_time(time_set,'N_nodes')$(ord(time_set)=round(time_wall,0)) =  0 ;
 317  tot_results_s_time(time_set,'UB')$(ord(time_set)=round(time_solve,0)) =  UBP ;
 318  tot_results_s_time(time_set,'LB')$(ord(time_set)=round(time_solve,0)) =  LBP ;
 319  tot_results_s_time(time_set,'N_nodes')$(ord(time_set)=round(time_solve,0)) =  0 ;
 320   
 321   
 322  loop(level2$(ord(level2)<=card(k) and check_opt=0 and time_solve<time_limit),
 323     aux3=ord(level2);
 324  *decide branching disjunction
 325     k_select(k)=no;
 326     min_i = smin(chec_int_k(k),term(k));
 327     aux1=0;
 328     loop(k$(term(k)=min_i and aux1=0 and chec_int_k(k)),k_select(k) = yes; aux1=1;);
 329     chec_int_k(k_select) = no;
 330   
 331  *Create nodes
 332     node(level2,ki(k_select(k),i))$(ord(level2)=aux3) = yes;
 333  *node(level2,ki(k_select(k),i)) = yes;
 334     no_ki_param(ki)=sum(level,node(level,ki));
 335     alive_ki(ki)$no_ki_param(ki)=no;
 336   
 337     nnode2(numm,kk,k,i)$(ord(numm)<=aux2)=no;
 338     aux1=1;
 339  *   aux2=1;
 340   
 341     if(aux3=1,
 342        loop(node(level2,k,i)$(ord(level2)=1),
 343           nnode2(numm,level2,k,i)$(ord(numm)=aux1)=yes;
 344           aux1=aux1+1;
 345        );
 346     parent_val(numm)$(ord(numm)<aux1) = LBP;
 347     );
 348   
 349  *$ontext
 350     numm_aux1(numm)$(sum(nnode(numm,level,k,i),1)>=1)=yes;
 351   
 352     loop(numm_aux1,
GAMS 24.8.4  r60966 Released Apr 10, 2017 LEX-LEG x86 64bit/Linux                                                                                                                                                                     04/09/18 11:41:03 Page 10
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
C o m p i l a t i o n


 353        loop(node(level2,kk,ii)$(ord(level2)=aux3),
 354           numm_aux2(numm2)$(ord(numm2)=aux1)=yes;
 355           nnode2(numm_aux2,level,k,i)$nnode(numm_aux1,level,k,i)=yes;
 356           nnode2(numm_aux2,level2,kk,ii)=yes;
 357           parent_val(numm_aux2) = node_val(numm_aux1);
 358           numm_aux2(numm2)$(ord(numm2)=aux1)=no;
 359           aux1=aux1+1;
 360        );
 361     );
 362     numm_aux1(numm)$(sum(nnode(numm,level,k,i),1)>=1)=no;
 363  *$offtext
 364   
 365   
 366     aux2=aux1;
 367     max_nod(level2)=aux2-1;
 368     nnode(numm,kk,k,i)=no;nnode(nnode2)=yes;
 369   
 370  *Solve nodes
 371     chec_int_k(k)=no;
 372     new_UB=0;
 373   
 374     node_val(numm)$(sum(nnode(numm,level,kk,ii),1)>=1) = parent_val(numm);
 375   
 376     loop(numm$(sum(nnode(numm,level,kk,ii),1)>=1 and time_solve<time_limit),
 377   
 378        if((parent_val(numm)<=(1-gap)*UBP) and (parent_val(numm)<=(1+gap)*UBP),
 379           chec_int(k,i)=0; int_sol=0; int_sol3=0;
 380           cur_node(k,i)=no;
 381           y.lo(k,i)=0;y.up(k,i)=1;
 382           loop(nnode(numm,level,kk,ii),cur_node(kk,ii)=yes;y.fx(kk,ii)=1);
 383   
 384  *$ontext
 385  **************** Option 1
 386           solve BigM using rmip min cost;
 387           time_solve = time_solve + bigM.etsolve;
 388           time_wall = (jnow-time_start)*3600*24;
 389           cpu_time = cpu_time + bigM.resUsd;
 390           loop(ki2, if((y.l(ki2)>=1-tol or y.l(ki2)<=tol),chec_int(ki2)=1););
 391           if(sum(ki2,chec_int(ki2))=sum(ki2,1),int_sol3=1;);
 392           if(BigM.modelstat<>1,int_sol3=0;);
 393   
 394           time_wall = (jnow-time_start)*3600*24;
 395           cnt_nodes = cnt_nodes+1;
 396   
 397           node_val(numm)= BigM.objval;node_stat(numm)= BigM.modelstat;
 398           chec_int(k,i)=0; int_sol=0;
 399           loop(ki2, if((y.l(ki2)>=1-tol or y.l(ki2)<=tol),chec_int(ki2)=1););
 400           if(sum(ki2,chec_int(ki2))=sum(ki2,1),int_sol=1; else chec_int_k(k)=yes;);
 401           if(BigM.modelstat<>1,int_sol=0;);
 402           node_int(numm)=int_sol;
 403           new_UB=int_sol;
 404           if(int_sol=1,
 405              if(BigM.objval<UBP,UBP=BigM.objval;opt_y(ki)=y.l(ki); opt_x(var)=x.l(var);best_inter=cnt_nodes-1;);
GAMS 24.8.4  r60966 Released Apr 10, 2017 LEX-LEG x86 64bit/Linux                                                                                                                                                                     04/09/18 11:41:03 Page 11
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
C o m p i l a t i o n


 406              if(aux_inter=0,first_inter=cnt_nodes-1;first_inter_val=UBP;aux_inter=1;);
 407           );
 408   
 409  *printing solution
 410           if(cnt_calculate_LB=calculate_LB,
 411              LBP = smin(numm2$(sum(nnode(numm2,level,kk,ii),1)>=1 and ((node_stat(numm2)=1 and node_int(numm2)<>1) or ord(numm2)>ord(numm)) and node_val(numm2)<=UBP),node_val(numm2));
 412              cnt_calculate_LB=-1;
 413           );
 414           cnt_calculate_LB = cnt_calculate_LB+1;
 415           tot_results_w_time(time_set,'UB')$(ord(time_set)=round(time_wall,0)) =  UBP ;
 416           tot_results_w_time(time_set,'LB')$(ord(time_set)=round(time_wall,0)) =  LBP ;
 417           tot_results_w_time(time_set,'N_nodes')$(ord(time_set)=round(time_wall,0)) =  cnt_nodes-1 ;
 418           tot_results_s_time(time_set,'UB')$(ord(time_set)=round(time_solve,0)) =  UBP ;
 419           tot_results_s_time(time_set,'LB')$(ord(time_set)=round(time_solve,0)) =  LBP ;
 420           tot_results_s_time(time_set,'N_nodes')$(ord(time_set)=round(time_solve,0)) =  cnt_nodes-1 ;
 421        else node_val(numm) = parent_val(numm);
 422        );
 423     );
 424   
 425  *Remove nodes
 426     nnode(numm,level,kk,ii)$(node_stat(numm)<>1)=no;
 427     nnode(numm,level,kk,ii)$(node_int(numm)=1)=no;
 428     nnode(numm,level,kk,ii)$((node_val(numm)>=(1-gap)*UBP) or (node_val(numm)>=(1+gap)*UBP))=no;
 429  *   LBP = smin(numm2$(sum(nnode(numm2,level,kk,ii),1)>=1 and node_stat(numm2)=1 and node_int(numm2)<>1),node_val(numm2));
 430   
 431     chec_int_k(k)$(sum(alive_ki(k,i),1)=0)=no;
 432   
 433     if(sum(nnode(numm,level,kk,ii),1)=0,check_opt=1;);
 434     execute_unload "res_B_B_BM2" tot_results_w_time,tot_results_s_time,first_inter,first_inter_val,best_inter,opt_y,opt_x,max_nod;
 435   
 436  );
 437   
 438  execute_unload "res_B_B_BM2" tot_results_w_time,tot_results_s_time,first_inter,first_inter_val,best_inter,opt_y,opt_x,max_nod,check_opt,UBP,LBP;
 439   
 440  LBP = min(LBP,UBP);
 441  scalar sol,nodes,time,LBL,first,best,const,vars,bin;
 442  sol = UBP;
 443  nodes = cnt_nodes-1;
 444  time  = time_solve;
 445  cpu   = cpu_time;
****    $140
**** LINE    251 INPUT       /home/bernalde/IntroToMLProj/GDP_Refomulation_NN/data/Logic_based_B_B_contracts/Euler/4/Logic_B_B_BM2.gms
 446  LBL   = LBP;
 447  first = first_inter;
 448  best  = best_inter;
 449   
 450  execute_unload "res_prob" sol,nodes,time,cpu,LBL,first,best;
 451   
 452   

**** LIST OF STRAY NAMES - CHECK DECLARATIONS FOR SPURIOUS COMMAS
**** STRAY NAME const OF TYPE PARAM
**** STRAY NAME vars OF TYPE PARAM
GAMS 24.8.4  r60966 Released Apr 10, 2017 LEX-LEG x86 64bit/Linux                                                                                                                                                                     04/09/18 11:41:03 Page 12
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
C o m p i l a t i o n


**** STRAY NAME bin OF TYPE PARAM
GAMS 24.8.4  r60966 Released Apr 10, 2017 LEX-LEG x86 64bit/Linux                                                                                                                                                                     04/09/18 11:41:03 Page 13
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
Error Messages


140  Unknown symbol

**** 1 ERROR(S)   0 WARNING(S)
GAMS 24.8.4  r60966 Released Apr 10, 2017 LEX-LEG x86 64bit/Linux                                                                                                                                                                     04/09/18 11:41:03 Page 14
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
Include File Summary


   SEQ   GLOBAL TYPE      PARENT   LOCAL  FILENAME

     1        1 INPUT          0       0  /home/bernalde/IntroToMLProj/GDP_Refomulation_NN/data/Logic_based_B_B_contracts/Euler/4/Logic_B_B_BM2.gms
     2      244 INCLUDE        1      51  ./home/bernalde/IntroToMLProj/GDP_Refomulation_NN/data/Logic_based_B_B_contracts/Euler/4/max_time_ref.gms


COMPILATION TIME     =        0.307 SECONDS     51 MB  24.8.4 r60966 LEX-LEG


USER: Eval License Carnegie Mellon University        G180112/0001AS-GEN
      Dept. of Chemical Engineering                              DC9476
      License for teaching and research at degree granting institutions


**** FILE SUMMARY

Restart    /home/bernalde/IntroToMLProj/GDP_Refomulation_NN/data/Logic_based_B_B_contracts/Euler/4/0.g00
Input      /home/bernalde/IntroToMLProj/GDP_Refomulation_NN/data/Logic_based_B_B_contracts/Euler/4/Logic_B_B_BM2.gms
Output     /home/bernalde/IntroToMLProj/GDP_Refomulation_NN/data/Logic_based_B_B_contracts/Euler/4/Logic_B_B_BM2.lst

**** USER ERROR(S) ENCOUNTERED
